{"content":"bG9jYWwgY2xpZW50X2V5ZV9wb3NpdGlvbiwgY2xpZW50X3NldF9ldmVudF9jYWxsYmFjaywgY2xpZW50X3VzZXJpZF90b19lbnRpbmRleCwgZW50aXR5X2dldF9jbGFzc25hbWUsIGVudGl0eV9nZXRfbG9jYWxfcGxheWVyLCBlbnRpdHlfZ2V0X3BsYXllcl93ZWFwb24sIGVudGl0eV9nZXRfcHJvcCwgZW50aXR5X2lzX2FsaXZlLCBtYXRoX2F0YW4yLCBtYXRoX2NvcywgbWF0aF9kZWcsIG1hdGhfcmFkLCBtYXRoX3NpbiwgbWF0aF9zcXJ0LCByZW5kZXJlcl9saW5lLCByZW5kZXJlcl90cmlhbmdsZSwgcmVuZGVyZXJfd29ybGRfdG9fc2NyZWVuLCB1aV9nZXQsIHVpX25ld19jaGVja2JveCwgdWlfbmV3X2NvbG9yX3BpY2tlciwgdWlfbmV3X2hvdGtleSwgdWlfbmV3X211bHRpc2VsZWN0LCB1aV9uZXdfc2xpZGVyLCB1aV9yZWZlcmVuY2UsIHVpX3NldCwgdWlfc2V0X2NhbGxiYWNrLCB1aV9zZXRfdmlzaWJsZSA9IGNsaWVudC5leWVfcG9zaXRpb24sIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2ssIGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgsIGVudGl0eS5nZXRfY2xhc3NuYW1lLCBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllciwgZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uLCBlbnRpdHkuZ2V0X3Byb3AsIGVudGl0eS5pc19hbGl2ZSwgbWF0aC5hdGFuMiwgbWF0aC5jb3MsIG1hdGguZGVnLCBtYXRoLnJhZCwgbWF0aC5zaW4sIG1hdGguc3FydCwgcmVuZGVyZXIubGluZSwgcmVuZGVyZXIudHJpYW5nbGUsIHJlbmRlcmVyLndvcmxkX3RvX3NjcmVlbiwgdWkuZ2V0LCB1aS5uZXdfY2hlY2tib3gsIHVpLm5ld19jb2xvcl9waWNrZXIsIHVpLm5ld19ob3RrZXksIHVpLm5ld19tdWx0aXNlbGVjdCwgdWkubmV3X3NsaWRlciwgdWkucmVmZXJlbmNlLCB1aS5zZXQsIHVpLnNldF9jYWxsYmFjaywgdWkuc2V0X3Zpc2libGUNCmxvY2FsIGZ1bmN0aW9uIHRyeV9yZXF1aXJlKG1vZHVsZSwgbXNnKQ0KICAgIGxvY2FsIHN1Y2Nlc3MsIHJlc3VsdCA9IHBjYWxsKHJlcXVpcmUsIG1vZHVsZSkNCiAgICBpZiBzdWNjZXNzIHRoZW4gcmV0dXJuIHJlc3VsdCBlbHNlIHJldHVybiBlcnJvcihtc2cpIGVuZA0KZW5kDQpsb2NhbCB2ZWN0b3IgPSB0cnlfcmVxdWlyZSgidmVjdG9yIiwgIk1pc3NpbmcgdmVjdG9yIikNCg0KbG9jYWwgcXVpY2tzdG9wX3JlZmVyZW5jZSA9IHVpLnJlZmVyZW5jZSgiUkFHRSIsICJBaW1ib3QiLCAiUXVpY2sgc3RvcCIpDQpsb2NhbCByZWZfaGNfcmVmID0gdWkucmVmZXJlbmNlKCdyYWdlJywgJ2FpbWJvdCcsICdtaW5pbXVtIGhpdCBjaGFuY2UnKQ0KbG9jYWwgcHJlZmVlcl9zcCA9IHVpLnJlZmVyZW5jZSgiUkFHRSIsICJhaW1ib3QiLCAiUHJlZmVyIHNhZmUgcG9pbnQiKQ0KbG9jYWwgZm9yY2Vfc3Bfa2V5cyA9IHVpLnJlZmVyZW5jZSgiUkFHRSIsICJhaW1ib3QiLCAiRm9yY2Ugc2FmZSBwb2ludCIpDQpsb2NhbCBlbmFibGVkX3JlZmVyZW5jZSwgaG90a2V5X3JlZmVyZW5jZSA9IHVpX3JlZmVyZW5jZSgiUkFHRSIsICJPdGhlciIsICJRdWljayBwZWVrIGFzc2lzdCIpDQoNCmxvY2FsIGZmaSA9IHJlcXVpcmUgJ2ZmaScNCg0KbG9jYWwgY2xhc3NwdHIgPSBmZmkudHlwZW9mKCd2b2lkKioqJykNCmxvY2FsIHJhd2llbnRpdHlsaXN0ID0gY2xpZW50LmNyZWF0ZV9pbnRlcmZhY2UoJ2NsaWVudC5kbGwnLCAnVkNsaWVudEVudGl0eUxpc3QwMDMnKSBvcg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ1ZDbGllbnRFbnRpdHlMaXN0MDAzIHdhc250IGZvdW5kJywgMikNCg0KbG9jYWwgaWVudGl0eWxpc3QgPSBmZmkuY2FzdChjbGFzc3B0ciwgcmF3aWVudGl0eWxpc3QpIG9yIGVycm9yKCdyYXdpZW50aXR5bGlzdCBpcyBuaWwnLCAyKQ0KbG9jYWwgZ2V0X2NsaWVudF9uZXR3b3JrYWJsZSA9IGZmaS5jYXN0KCd2b2lkKihfX3RoaXNjYWxsKikodm9pZCosIGludCknLCBpZW50aXR5bGlzdFswXVswXSkgb3INCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ2dldF9jbGllbnRfbmV0d29ya2FibGVfdCBpcyBuaWwnLCAyKQ0KbG9jYWwgZ2V0X2NsaWVudF9lbnRpdHkgPSBmZmkuY2FzdCgndm9pZCooX190aGlzY2FsbCopKHZvaWQqLCBpbnQpJywgaWVudGl0eWxpc3RbMF1bM10pIG9yDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcignZ2V0X2NsaWVudF9lbnRpdHkgaXMgbmlsJywgMikNCg0KbG9nID0gew0KICAgIGRlc3luY3NpemUgPSAwDQoNCn0NCg0KbG9jYWwgcmF3aXZtb2RlbGluZm8gPSBjbGllbnQuY3JlYXRlX2ludGVyZmFjZSgnZW5naW5lLmRsbCcsICdWTW9kZWxJbmZvQ2xpZW50MDA0JykNCmxvY2FsIGl2bW9kZWxpbmZvID0gZmZpLmNhc3QoY2xhc3NwdHIsIHJhd2l2bW9kZWxpbmZvKSBvciBlcnJvcigncmF3aXZtb2RlbGluZm8gaXMgbmlsJywgMikNCmxvY2FsIGdldF9zdHVkaW9fbW9kZWwgPSBmZmkuY2FzdCgndm9pZCooX190aGlzY2FsbCopKHZvaWQqLCBjb25zdCB2b2lkKiknLCBpdm1vZGVsaW5mb1swXVszMl0pDQoNCmxvY2FsIGxhYmVsMjMxID0gdWkubmV3X2xhYmVsKCJSYWdlIiwgIk90aGVyIiwgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQ0KbG9jYWwgbGFiZWw5ODczMSA9IHVpLm5ld19sYWJlbCgiUmFnZSIsICJPdGhlciIsICIgICAgICAgICAgICAgICAgICAgICAgICAgXGFDMTdGODJGRkFcYUFBNzY4MUZGSVxhQTI3NjhBRkZNXGE5OTc2OTNGRlRcYTlCN0ZBN0ZGT1xhOTI3RkIxRkZPXGE4MDc2QURGRkxcYTg5N0ZCQUZGUyIpDQoNCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBhaW50X3VpIiwgZnVuY3Rpb24oKQ0KICAgIHVpLnNldChsYWJlbDk4NzMxLCAiICAgICAgICAgICAgICAgICAgICAgICAgICIgLi4gYW5pbWF0ZV90ZXh0KGdsb2JhbHMuY3VydGltZSgpICogMS4yLCAiQUlNVE9PTFMiLCAxMjUsMTA2LDE2MCwyNTUsMjEwLDEyNSwxMjksMjU1KSkNCmVuZCkNCg0KbG9jYWwgZW5hYmxlID0gdWkubmV3X2NoZWNrYm94KCJSYWdlIiwgIk90aGVyIiwgIlxhRkZGOUZGOTlbXGFBNTdGOUVGRitcYUZGRjlGRjk5XSBCZXR0ZXIgSklUVEVSLyBMQlkgLyBPTlNIT1QgY29ycmVjdGlvbiIpDQpsb2NhbCBkcmF3X3JlZmVyZW5jZSA9IHVpX25ld19jaGVja2JveCgiUkFHRSIsICJPdGhlciIsICJcYUZGRjlGRjk5W1xhQTU3RjlFRkYrXGFGRkY5RkY5OV1CZXR0ZXIgcXVpY2sgcGVlayIpDQpsb2NhbCBjb2xvcl9yZWZlcmVuY2UgPSB1aV9uZXdfY29sb3JfcGlja2VyKCJSQUdFIiwgIk90aGVyIiwgIlF1aWNrIHBlZWsgY29sb3IiLCAyNTUsIDI1NSwgMjU1LCAyNTUpDQoNCnVpLm5ld19sYWJlbCgiUmFnZSIsICJPdGhlciIsICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09IikNCg0KZmZpLmNkZWYgW1sNCiAgICBzdHJ1Y3QgY19hbmltc3RhdGUgew0KICAgICAgICBjaGFyIHBhZFszXTsNCiAgICAgICAgY2hhciBtX2JGb3JjZVdlYXBvblVwZGF0ZTsgLy8gMHg0DQogICAgICAgIGNoYXIgcGFkMVs5MV07DQogICAgICAgIHZvaWQqIG1fcEJhc2VFbnRpdHk7IC8vIDB4NjANCiAgICAgICAgdm9pZCogbV9wQWN0aXZlV2VhcG9uOyAvLyAweDY0DQogICAgICAgIHZvaWQqIG1fcExhc3RBY3RpdmVXZWFwb247IC8vIDB4NjgNCiAgICAgICAgZmxvYXQgbV9mbExhc3RDbGllbnRTaWRlQW5pbWF0aW9uVXBkYXRlVGltZTsgLy8gMHg2Qw0KICAgICAgICBpbnQgbV9pTGFzdENsaWVudFNpZGVBbmltYXRpb25VcGRhdGVGcmFtZWNvdW50OyAvLyAweDcwDQogICAgICAgIGZsb2F0IG1fZmxBbmltVXBkYXRlRGVsdGE7IC8vIDB4NzQNCiAgICAgICAgZmxvYXQgbV9mbEV5ZVlhdzsgLy8gMHg3OA0KICAgICAgICBmbG9hdCBtX2ZsR29hbEZlZXRZYXc7IC8vIDB4ODANCiAgICAgICAgZmxvYXQgbV9mbEN1cnJlbnRGZWV0WWF3OyAvLyAweDgwDQogICAgICAgIGZsb2F0IG1fYW5nRXllQW5nbGVzOw0KICAgICAgICBmbG9hdCBtX2ZsQ3VycmVudEZlZXRZYXc7IC8vIDB4ODQgICANCiAgICAgICAgZmxvYXQgbV9mbEN1cnJlbnRUb3Jzb1lhdzsgLy8gMHg4OA0KICAgICAgICBmbG9hdCBtX2ZsU3BlZWROb3JtYWxpemVkOyAvLyAweEY0DQogICAgICAgIGJvb2wgbV9iT25Hcm91bmQ7IC8vIDB4MTA4DQogICAgfTsNCl1dDQoNClJHQkF0b0hFWCA9IGZ1bmN0aW9uKHJlZEFyZywgZ3JlZW5BcmcsIGJsdWVBcmcsIGFscGhhQXJnKQ0KICAgIHJldHVybiBzdHJpbmcuZm9ybWF0KCclLjJ4JS4yeCUuMnglLjJ4JywgcmVkQXJnLCBncmVlbkFyZywgYmx1ZUFyZywgYWxwaGFBcmcpDQplbmQNCg0KYW5pbWF0ZV90ZXh0ID0gZnVuY3Rpb24odGltZSwgc3RyaW5nLCByLCBnLCBiLCBhLCByMiwgZzIsIGIyLCBhMikNCiAgICBsb2NhbCB0X291dCA9IHt9DQogICAgbG9jYWwgbCA9IHN0cmluZzpsZW4oKSAtIDENCiAgICBsb2NhbCByX2FkZCA9IChyMiAtIHIpDQogICAgbG9jYWwgZ19hZGQgPSAoZzIgLSBnKQ0KICAgIGxvY2FsIGJfYWRkID0gKGIyIC0gYikNCiAgICBsb2NhbCBhX2FkZCA9IChhMiAtIGEpDQoNCiAgICBmb3IgaSA9IDEsICNzdHJpbmcgZG8NCiAgICAgICAgbG9jYWwgaXRlciA9IChpIC0gMSkgLyAoI3N0cmluZyAtIDEpICsgdGltZQ0KICAgICAgICB0X291dFsjdF9vdXQgKyAxXSA9ICJcYSIgLi4gUkdCQXRvSEVYKHIgKyByX2FkZCAqIG1hdGguYWJzKG1hdGguY29zKGl0ZXIpKSwgZyArIGdfYWRkICogbWF0aC5hYnMobWF0aC5jb3MoaXRlcikpLCBiICsgYl9hZGQgKiBtYXRoLmFicyhtYXRoLmNvcyhpdGVyKSksIGEgKyBhX2FkZCAqIG1hdGguYWJzKG1hdGguY29zKGl0ZXIpKSkNCiAgICAgICAgdF9vdXRbI3Rfb3V0ICsgMV0gPSBzdHJpbmc6c3ViKGksIGkpDQogICAgZW5kDQoNCiAgICByZXR1cm4gdGFibGUuY29uY2F0KHRfb3V0KQ0KZW5kDQoNCiAgICBjbGFtcCA9IGZ1bmN0aW9uICh4LCBhLCBiKSBpZiBhID4geCB0aGVuIHJldHVybiBhIGVsc2VpZiBiIDwgeCB0aGVuIHJldHVybiBiIGVsc2UgcmV0dXJuIHggZW5kIGVuZA0KDQogICAgbm9ybWFsaXplX3lhdyA9IGZ1bmN0aW9uKHlhdykNCiAgICAgICAgd2hpbGUgeWF3ID4gMTgwIGRvIHlhdyA9IHlhdyAtIDM2MCBlbmQNCiAgICAgICAgd2hpbGUgeWF3IDwgLTE4MCBkbyB5YXcgPSB5YXcgKyAzNjAgZW5kDQogICAgICAgIHJldHVybiB5YXcNCiAgICBlbmQNCg0KbGVycCA9IGZ1bmN0aW9uKGEsIGIsIHQpDQogICAgcmV0dXJuIGEgKyB0ICogKGIgLSBhKQ0KZW5kDQoNCg0KbG9jYWwgbWlzYyA9IHsgfSBkbw0KICAgIG1pc2MuYWltX3Rvb2xzID0geyB9IGRvDQogICAgICAgIG1pc2MuYWltX3Rvb2xzLmNvcnJlY3Rpb24gPSB7IH0gZG8NCiAgICAgICAgICAgIGZ1bmN0aW9uIGdldF92ZWN0b3IoZW50LCBwcm9wKQ0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgIHggPSBlbnRpdHkuZ2V0X3Byb3AoZW50LCBwcm9wLCAwKSwNCiAgICAgICAgICAgICAgICAgICAgeSA9IGVudGl0eS5nZXRfcHJvcChlbnQsIHByb3AsIDEpLA0KICAgICAgICAgICAgICAgICAgICB6ID0gZW50aXR5LmdldF9wcm9wKGVudCwgcHJvcCwgMikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBlbmQNCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGVfYW5nbGUoc3JjLCBkc3QpDQogICAgICAgICAgICAgICAgbG9jYWwgZHggPSBkc3QueCAtIHNyYy54DQogICAgICAgICAgICAgICAgbG9jYWwgZHkgPSBkc3QueSAtIHNyYy55DQogICAgICAgICAgICAgICAgbG9jYWwgYW5nbGUgPSBtYXRoLmRlZyhtYXRoLmF0YW4yKGR5LCBkeCkpDQogICAgICAgICAgICAgICAgaWYgYW5nbGUgPCAwIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgYW5nbGUgPSBhbmdsZSArIDM2MA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIHJldHVybiBhbmdsZQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIA0KICAgICAgICAgICAgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5nZXRfYW5pbV9zdGF0ZSA9IGZ1bmN0aW9uKHBsYXllcikNCiAgICAgICAgICAgICAgICBpZiBub3QgcGxheWVyIHRoZW4gcmV0dXJuIG5pbCBlbmQNCiAgICAgICAgICAgICAgICBsb2NhbCBwbGF5ZXJfcHRyID0gZmZpLmNhc3QoInZvaWQqKioiLCBnZXRfY2xpZW50X2VudGl0eShpZW50aXR5bGlzdCwgcGxheWVyKSkNCiAgICAgICAgICAgICAgICBsb2NhbCBhbmltc3RhdGVfcHRyID0gZmZpLmNhc3QoImNoYXIqIiwgcGxheWVyX3B0cikgKyAweDk5NjANCiAgICAgICAgICAgICAgICByZXR1cm4gZmZpLmNhc3QoInN0cnVjdCBjX2FuaW1zdGF0ZSoqIiwgYW5pbXN0YXRlX3B0cilbMF0NCiAgICAgICAgICAgIGVuZA0KICAgICAgICANCiAgICAgICAgICAgIG1pc2MuYWltX3Rvb2xzLmNvcnJlY3Rpb24ub2xkX2dvYWxfZmVldF95YXcgPSB7fQ0KICAgICAgICAgICAgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5jdXJyZW50X2dvYWxfZmVldF95YXcgPSB7fQ0KICAgICAgICAgICAgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5oaXN0b3J5ID0ge30NCiAgICAgICAgDQogICAgICAgICAgICBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLnVwZGF0ZV9yZWNvcmQgPSBmdW5jdGlvbihwbGF5ZXIpDQogICAgICAgICAgICAgICAgbG9jYWwgc2ltdGltZSA9IGVudGl0eS5nZXRfcHJvcChwbGF5ZXIsICJtX2ZsU2ltdWxhdGlvblRpbWUiKQ0KICAgICAgICAgICAgICAgIGlmIG5vdCBzaW10aW1lIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICANCiAgICAgICAgICAgICAgICBpZiBub3QgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5oaXN0b3J5W3BsYXllcl0gdGhlbg0KICAgICAgICAgICAgICAgICAgICBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLmhpc3RvcnlbcGxheWVyXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1ciA9IG5pbCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXYgPSBuaWwsDQogICAgICAgICAgICAgICAgICAgICAgICBwcmVfcHJldiA9IG5pbCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZV9wcmVfcHJldiA9IG5pbCwNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGxvY2FsIGhpc3QgPSBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLmhpc3RvcnlbcGxheWVyXQ0KICAgICAgICANCiAgICAgICAgICAgICAgICBpZiBub3QgaGlzdC5jdXIgb3IgKHNpbXRpbWUgLSBoaXN0LmN1ci5zaW10aW1lID49IDEpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbmV3X3JlY29yZCA9IHt9DQogICAgICAgICAgICAgICAgICAgIG5ld19yZWNvcmQuaWQgPSBwbGF5ZXINCiAgICAgICAgICAgICAgICAgICAgbmV3X3JlY29yZC5vcmlnaW4gPSBnZXRfdmVjdG9yKHBsYXllciwgIm1fdmVjT3JpZ2luIikNCiAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGV5ZV9hbmdsZXMgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwaXRjaCA9IGVudGl0eS5nZXRfcHJvcChwbGF5ZXIsICJtX2FuZ0V5ZUFuZ2xlc1swXSIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgeWF3ID0gZW50aXR5LmdldF9wcm9wKHBsYXllciwgIm1fYW5nRXllQW5nbGVzWzFdIikNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBuZXdfcmVjb3JkLnBpdGNoID0gZXllX2FuZ2xlcy5waXRjaA0KICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbG9jYWxfcGxheWVyID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBzaG9vdGVyX29yaWdpbiA9IGdldF92ZWN0b3IobG9jYWxfcGxheWVyLCAibV92ZWNPcmlnaW4iKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjYWxjdWxhdGVkX2FuZ2xlID0gY2FsY3VsYXRlX2FuZ2xlKHNob290ZXJfb3JpZ2luLCBuZXdfcmVjb3JkLm9yaWdpbikNCiAgICAgICAgICAgICAgICAgICAgbmV3X3JlY29yZC55YXcgPSBtYXRoLmZsb29yKGV5ZV9hbmdsZXMueWF3IC0gY2FsY3VsYXRlZF9hbmdsZSkNCiAgICAgICAgICAgICAgICAgICAgbmV3X3JlY29yZC55YXdfYmFja3dhcmRzID0gbWF0aC5mbG9vcigoZXllX2FuZ2xlcy55YXcgLSAxODApIC0gY2FsY3VsYXRlZF9hbmdsZSkNCiAgICAgICAgICAgICAgICAgICAgbmV3X3JlY29yZC5zaW10aW1lID0gc2ltdGltZQ0KICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZmxhZ3MgPSBlbnRpdHkuZ2V0X3Byb3AocGxheWVyLCAibV9mRmxhZ3MiKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBvbl9ncm91bmQgPSBmbGFncyBhbmQgKGJpdC5iYW5kKGZsYWdzLCAxKSB+PSAwKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkdWNraW5nID0gZW50aXR5LmdldF9wcm9wKHBsYXllciwgIm1fYkR1Y2tpbmciKQ0KICAgICAgICAgICAgICAgICAgICBpZiBvbl9ncm91bmQgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmVsX3gsIHZlbF95ID0gZW50aXR5LmdldF9wcm9wKHBsYXllciwgIm1fdmVjVmVsb2NpdHkiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3BlZWQgPSBtYXRoLnNxcnQodmVsX3ggKiB2ZWxfeCArIHZlbF95ICogdmVsX3kpDQogICAgICAgICAgICAgICAgICAgICAgICBuZXdfcmVjb3JkLnN0YW5jZSA9IChzcGVlZCA+IDAuMSkgYW5kICJydW5uaW5nIiBvciAic3RhbmRpbmciDQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBkdWNraW5nIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19yZWNvcmQuc3RhbmNlID0gImR1Y2siDQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19yZWNvcmQuc3RhbmNlID0gImluIGFpciINCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBuZXdfcmVjb3JkLmVzcF9mbGFncyA9IDAgDQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBuZXdfcmVjb3JkLmxhc3Rfc2hvdF90aW1lID0gZW50aXR5LmdldF9wcm9wKHBsYXllciwgIm1fZmxMYXN0U2hvdFRpbWUiKSBvciAwDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRpY2tfaW50ZXJ2YWwgPSBnbG9iYWxzLnRpY2tpbnRlcnZhbCgpDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNob3RfdGhyZXNob2xkID0gbWF0aC5mbG9vcigwLjIgLyB0aWNrX2ludGVydmFsKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjdXJyZW50X3RpY2sgPSBnbG9iYWxzLnRpY2tjb3VudCgpDQogICAgICAgICAgICAgICAgICAgIGlmIG5ld19yZWNvcmQubGFzdF9zaG90X3RpbWUgPiAwIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGxhc3Rfc2hvdF90aWNrID0gbWF0aC5mbG9vcihuZXdfcmVjb3JkLmxhc3Rfc2hvdF90aW1lIC8gdGlja19pbnRlcnZhbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19yZWNvcmQucmVjZW50X3Nob3QgPSAoKGN1cnJlbnRfdGljayAtIGxhc3Rfc2hvdF90aWNrKSA8IHNob3RfdGhyZXNob2xkKQ0KICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICBuZXdfcmVjb3JkLnJlY2VudF9zaG90ID0gZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiBoaXN0LmN1ciB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBkaWZmID0gbm9ybWFsaXplX3lhdyhuZXdfcmVjb3JkLnlhdyAtIGhpc3QuY3VyLnlhdykNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19yZWNvcmQueWF3X2RpZmYgPSBtYXRoLmFicyhkaWZmKQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3JlY29yZC5zaWduZWRfeWF3X2RpZmYgPSBkaWZmDQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19yZWNvcmQueWF3X2RpZmYgPSAwDQogICAgICAgICAgICAgICAgICAgICAgICBuZXdfcmVjb3JkLnNpZ25lZF95YXdfZGlmZiA9IDANCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBoaXN0LnByZV9wcmVfcHJldiA9IGhpc3QucHJlX3ByZXYNCiAgICAgICAgICAgICAgICAgICAgaGlzdC5wcmVfcHJldiA9IGhpc3QucHJldg0KICAgICAgICAgICAgICAgICAgICBoaXN0LnByZXYgPSBoaXN0LmN1cg0KICAgICAgICAgICAgICAgICAgICBoaXN0LmN1ciA9IG5ld19yZWNvcmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICANCiAgICAgICAgICAgIG1pc2MuYWltX3Rvb2xzLmNvcnJlY3Rpb24ucHJlZGljdF95YXcgPSBmdW5jdGlvbihwbGF5ZXIsIGN1cnJlbnRfZ29hbCkNCiAgICAgICAgICAgICAgICBsb2NhbCBoaXN0ID0gbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5oaXN0b3J5W3BsYXllcl0NCiAgICAgICAgICAgICAgICBpZiBoaXN0IGFuZCBoaXN0LmN1ciBhbmQgaGlzdC5wcmV2IHRoZW4NCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlmZjEgPSBub3JtYWxpemVfeWF3KGhpc3QuY3VyLnlhdyAtIGhpc3QucHJldi55YXcpDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpZmYyID0gMA0KICAgICAgICAgICAgICAgICAgICBpZiBoaXN0LnByZV9wcmV2IHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYyID0gbm9ybWFsaXplX3lhdyhoaXN0LnByZXYueWF3IC0gaGlzdC5wcmVfcHJldi55YXcpDQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgd2VpZ2h0ZWRfZGlmZiA9IChkaWZmMSAqIDAuNyArIGRpZmYyICogMC4zKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwcmVkaWN0aW9uX2ZhY3RvciA9IDEuNQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwcmVkaWN0ZWRfeWF3ID0gY3VycmVudF9nb2FsICsgcHJlZGljdGlvbl9mYWN0b3IgKiB3ZWlnaHRlZF9kaWZmDQogICAgICAgICAgICAgICAgICAgIGlmIGhpc3QuY3VyLnJlY2VudF9zaG90IHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIHByZWRpY3RlZF95YXcgPSBwcmVkaWN0ZWRfeWF3ICsgNQ0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZV95YXcocHJlZGljdGVkX3lhdykNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBub3JtYWxpemVfeWF3KGN1cnJlbnRfZ29hbCkNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICANCiAgICAgICAgICAgIG1pc2MuYWltX3Rvb2xzLmNvcnJlY3Rpb24uY29ycmVjdF9hbmdsZSA9IGZ1bmN0aW9uKHBsYXllcikNCiAgICAgICAgICAgICAgICBpZiBub3QgcGxheWVyIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgICAgICAgIGlmIG5vdCB1aS5nZXQoZW5hYmxlKSB0aGVuIHJldHVybiBlbmQNCiAgICAgICAgICAgICAgICBpZiBub3QgdWkuZ2V0KGVuYWJsZSkgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgICAgICAgaWYgZW50aXR5LmlzX2Rvcm1hbnQocGxheWVyKSBvciBub3QgZW50aXR5LmlzX2FsaXZlKHBsYXllcikgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgICANCiAgICAgICAgICAgICAgICBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLnVwZGF0ZV9yZWNvcmQocGxheWVyKQ0KICAgICAgICAgICAgICAgIGxvY2FsIGhpc3QgPSBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLmhpc3RvcnlbcGxheWVyXQ0KICAgICAgICAgICAgICAgIGlmIG5vdCBoaXN0IG9yIG5vdCBoaXN0LmN1ciB0aGVuIHJldHVybiBlbmQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGxvY2FsIGFuaW1zdGF0ZSA9IG1pc2MuYWltX3Rvb2xzLmNvcnJlY3Rpb24uZ2V0X2FuaW1fc3RhdGUocGxheWVyKQ0KICAgICAgICAgICAgICAgIGlmIG5vdCBhbmltc3RhdGUgb3Igbm90IGFuaW1zdGF0ZS5tX2ZsR29hbEZlZXRZYXcgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgICAgICAgbG9jYWwgY3VycmVudF9nb2FsID0gYW5pbXN0YXRlLm1fZmxHb2FsRmVldFlhdw0KICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5vbGRfZ29hbF9mZWV0X3lhd1twbGF5ZXJdID0gbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5vbGRfZ29hbF9mZWV0X3lhd1twbGF5ZXJdIG9yIGN1cnJlbnRfZ29hbA0KICAgICAgICAgICAgICAgIGxvY2FsIG9sZF9nb2FsID0gbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5vbGRfZ29hbF9mZWV0X3lhd1twbGF5ZXJdDQogICAgICAgICAgICAgICAgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5jdXJyZW50X2dvYWxfZmVldF95YXdbcGxheWVyXSA9IGN1cnJlbnRfZ29hbA0KICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbG9jYWwgcHJlZGljdGVkX3lhdyA9IG1pc2MuYWltX3Rvb2xzLmNvcnJlY3Rpb24ucHJlZGljdF95YXcocGxheWVyLCBjdXJyZW50X2dvYWwpDQogICAgICAgICAgICANCiAgICAgICAgICAgICAgICBsb2NhbCBib2R5X3Bvc2UgPSBlbnRpdHkuZ2V0X3Byb3AocGxheWVyLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAxMSkgKiAxMjAgLSA2MA0KDQogICAgICAgICAgICAgICAgZW50aXR5LnNldF9wcm9wKHBsYXllciwgIm1fYW5nRXllQW5nbGVzWzFdIiwgYm9keV9wb3NlKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbG9jYWwgYmFzZV9jb3JyZWN0aW9uID0gbm9ybWFsaXplX3lhdyhwcmVkaWN0ZWRfeWF3IC0gYm9keV9wb3NlKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbG9jYWwgeWF3X2RlbHRhLCBwcmVkaWN0aXZlX2RlbHRhID0gMCwgMA0KICAgICAgICAgICAgICAgIGlmIGhpc3QuY3VyIGFuZCBoaXN0LnByZXYgdGhlbg0KICAgICAgICAgICAgICAgICAgICB5YXdfZGVsdGEgPSBub3JtYWxpemVfeWF3KGhpc3QuY3VyLnlhdyAtIGhpc3QucHJldi55YXcpDQogICAgICAgICAgICAgICAgICAgIHByZWRpY3RpdmVfZGVsdGEgPSBub3JtYWxpemVfeWF3KHByZWRpY3RlZF95YXcgLSBvbGRfZ29hbCkNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGxvY2FsIGppdHRlcl90aHJlc2hvbGQgPSAyDQogICAgICAgICAgICAgICAgbG9jYWwgaml0dGVyX2ZhY3RvciA9IDAuNQ0KICAgICAgICAgICAgICAgIGxvY2FsIGppdHRlcl9jb3JyZWN0aW9uID0gMA0KICAgICAgICAgICAgICAgIGlmIG1hdGguYWJzKHlhd19kZWx0YSkgPiBqaXR0ZXJfdGhyZXNob2xkIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgaml0dGVyX2NvcnJlY3Rpb24gPSB5YXdfZGVsdGEgKiBqaXR0ZXJfZmFjdG9yICsgcHJlZGljdGl2ZV9kZWx0YSAqIDAuMw0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgaGlzdC5jdXIucmVjZW50X3Nob3QgdGhlbg0KICAgICAgICAgICAgICAgICAgICBqaXR0ZXJfY29ycmVjdGlvbiA9IGppdHRlcl9jb3JyZWN0aW9uICogMC41DQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICANCiAgICAgICAgICAgICAgICBsb2NhbCBjb21iaW5lZF9jb3JyZWN0aW9uID0gYmFzZV9jb3JyZWN0aW9uICsgaml0dGVyX2NvcnJlY3Rpb24NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGxvY2FsIGZpbmFsX2NvcnJlY3Rpb24gPSBub3JtYWxpemVfeWF3KGNsYW1wKGNvbWJpbmVkX2NvcnJlY3Rpb24sIC02MCwgNjApKQ0KICAgICAgICAgICAgICAgIGxvZy5kZXN5bmNzaXplID0gZmluYWxfY29ycmVjdGlvbg0KICAgICAgICAgICAgICAgIGlmIHVpLmdldChlbmFibGUpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgcGxpc3Quc2V0KHBsYXllciwgIkZvcmNlIGJvZHkgeWF3IiwgdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgcGxpc3Quc2V0KHBsYXllciwgIkZvcmNlIGJvZHkgeWF3IHZhbHVlIiwgZmluYWxfY29ycmVjdGlvbikNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHBsaXN0LnNldChwbGF5ZXIsICJGb3JjZSBib2R5IHlhdyIsIGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICBwbGlzdC5zZXQocGxheWVyLCAiRm9yY2UgYm9keSB5YXcgdmFsdWUiLCAwKQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5vbGRfZ29hbF9mZWV0X3lhd1twbGF5ZXJdID0gY3VycmVudF9nb2FsDQogICAgICAgICAgICBlbmQNCiAgICAgICAgDQogICAgICAgICAgICBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLnVwZGF0ZSA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgICAgICBsb2NhbCBlbmVtaWVzID0gZW50aXR5LmdldF9wbGF5ZXJzKHRydWUpDQogICAgICAgICAgICAgICAgZm9yIF8sIGVuZW15IGluIGlwYWlycyhlbmVtaWVzKSBkbw0KICAgICAgICAgICAgICAgICAgICBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLmNvcnJlY3RfYW5nbGUoZW5lbXkpDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCg0KICAgICAgICAgICAgbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi5yZXNvbHZlcl9kZWJ1ZyA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgICAgICBsb2NhbCBlbmVtaWVzID0gZW50aXR5LmdldF9wbGF5ZXJzKHRydWUpDQogICAgICAgICAgICAgICAgZm9yIF8sIGVuZW15IGluIGlwYWlycyhlbmVtaWVzKSBkbw0KICAgICAgICAgICAgICAgICAgICBpZiBlbnRpdHkuaXNfYWxpdmUoZW5lbXkpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGhpc3QgPSBtaXNjLmFpbV90b29scy5jb3JyZWN0aW9uLmhpc3RvcnlbZW5lbXldDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBoaXN0IGFuZCBoaXN0LmN1ciB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGVidWdfaW5mbyA9IHN0cmluZy5mb3JtYXQoIlBsYXllcjogJXMsIFlhdzogJWQsIERpZmY6ICUuMmYsIFNob3Q6ICVzIiwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eS5nZXRfcGxheWVyX25hbWUoZW5lbXkpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdC5jdXIueWF3LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdC5jdXIueWF3X2RpZmYgb3IgMCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvc3RyaW5nKGhpc3QuY3VyLnJlY2VudF9zaG90KSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZA0KDQoNCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInJ1bl9jb21tYW5kIiwgZnVuY3Rpb24oY21kKQ0KbWlzYy5haW1fdG9vbHMuY29ycmVjdGlvbi51cGRhdGUoKQ0KZW5kKQ0KDQpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJsZXZlbF9pbml0IiwgZnVuY3Rpb24oKQ0KICAgIGlmIG5vdCB1aS5nZXQoZW5hYmxlKSB0aGVuIHJldHVybiBlbmQNCiAgICBqaXR0ZXJfY29ycmVjdGlvbiA9IDANCiAgICBwcmVkaWN0ZWRfeWF3ID0gMCANCmVuZCkNCg0KY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygicm91bmRfc3RhcnQiLCBmdW5jdGlvbigpDQogICAgaWYgbm90IHVpLmdldChlbmFibGUpIHRoZW4gcmV0dXJuIGVuZA0KICAgIGppdHRlcl9jb3JyZWN0aW9uID0gMA0KICAgIHByZWRpY3RlZF95YXcgPSAwIA0KZW5kKQ0KDQpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJhaW1fZmlyZSIsIGZ1bmN0aW9uKCkNCiAgICBpZiBub3QgdWkuZ2V0KGVuYWJsZSkgdGhlbiByZXR1cm4gZW5kDQogICAgaml0dGVyX2NvcnJlY3Rpb24gPSAwDQogICAgcHJlZGljdGVkX3lhdyA9IDAgDQplbmQpDQoNCmV4cGxvaXQgPSB7DQogICAgZGVmZW5zaXZlID0gMCwNCiAgICBkZWZlbnNpdmVfY2hlY2sgPSAwLA0KICAgIGNtZCA9IDAsDQogICAgbGFzdF9vcmlnaW4gPSBuaWwsDQogICAgb3JpZ2luID0gbmlsLA0KICAgIHRwX2Rpc3QgPSAwLA0KfQ0KDQptX250aWNrYmFzZSA9IDANCg0KY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygicHJlZGljdF9jb21tYW5kIiwgZnVuY3Rpb24oY21kKQ0KICAgIG1lID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQ0KCWlmIG5vdCAobWUgb3Igbm90IGVudGl0eS5pc19hbGl2ZShtZSkpIG9yIChleHBsb2l0LmNtZCB+PSBjbWQuY29tbWFuZF9udW1iZXIpIHRoZW4NCgkJcmV0dXJuDQoJZW5kDQoJbG9jYWwgbV9udGlja2Jhc2UgPSBlbnRpdHkuZ2V0X3Byb3AobWUsICJtX25UaWNrQmFzZSIpIG9yIDANCiAgICBleHBsb2l0LmRlZmVuc2l2ZV9jaGVjayA9IG1hdGgubWF4KG1fbnRpY2tiYXNlLCBleHBsb2l0LmRlZmVuc2l2ZV9jaGVjaykNCglleHBsb2l0LmRlZmVuc2l2ZSA9IG1hdGgubWluKDE0LCBtYXRoLm1heCgwLCBleHBsb2l0LmRlZmVuc2l2ZV9jaGVjayAtIG1fbnRpY2tiYXNlIC0gMSkpDQplbmQpDQoNCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInJ1bl9jb21tYW5kIiwgZnVuY3Rpb24oY21kKQ0KICAgIGV4cGxvaXQuY21kID0gY21kLmNvbW1hbmRfbnVtYmVyDQplbmQpDQoNCmxvY2FsIHN0b3JlZF9zaG90ID0ge30NCmxvY2FsIGhpdGdyb3VwX25hbWVzID0geyJnZW5lcmljIiwgImhlYWQiLCAiY2hlc3QiLCAic3RvbWFjaCIsICJsZWZ0IGFybSIsICJyaWdodCBhcm0iLCAibGVmdCBsZWciLCAicmlnaHQgbGVnIiwgIm5lY2siLCAiPyIsICJnZWFyIn0NCg0KbG9jYWwgZXhwbG9pdCA9IHsNCiAgICBkZWZlbnNpdmUgPSAwLA0KICAgIGRlZmVuc2l2ZV9jaGVjayA9IDAsDQogICAgY21kID0gMCwNCn0NCg0KY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygiYWltX2ZpcmUiLCBmdW5jdGlvbihlKQ0KICAgIGlmIG5vdCB1aS5nZXQoZW5hYmxlKSBvciBlLnRhcmdldCA9PSBuaWwgdGhlbiByZXR1cm4gZW5kDQogICAgc3RvcmVkX3Nob3QgPSB7DQogICAgICAgIGRhbWFnZSA9IGUuZGFtYWdlLA0KICAgICAgICBib29zdGVkID0gZS5ib29zdGVkLA0KICAgICAgICBiYWNrdHJhY2sgPSBlLnRpY2sNCiAgICB9DQoNCiAgICBsb2NhbCBwbGF5ZXIgPSBlLnRhcmdldA0KICAgIGxvY2FsIGdyb3VwID0gaGl0Z3JvdXBfbmFtZXNbZS5oaXRncm91cCArIDFdIG9yICI/Ig0KICAgIGxvY2FsIGlzX2RlZmVuc2l2ZSA9IGV4cGxvaXQuZGVmZW5zaXZlID4gMiBhbmQgZXhwbG9pdC5kZWZlbnNpdmUgPCAxMg0KICAgIA0KICAgIC0tIEdldCByZXNvbHZlciBtb2RlDQogICAgcmVzb2x2ZXJfbWV0aG9kID0gIih3aWRlIGppdHRlciBkZXRlY3Rpb24gKG5ldHdvcmtlZC55IC0gcHJldmlvdXMgPiA1MCkiDQogICAgbG9jYWwgaGl0X21lc3NhZ2UgPSBuaWwNCg0KICAgIGxvY2FsIGJ0X29uID0gZ2xvYmFscy50aWNrY291bnQoKSAtIGUudGljayA+IDANCiAgICBpZiByZXNvbHZlcl9tZXRob2QgPT0gIkRJU0FCTEVEIiBvciBwbGlzdC5nZXQocGxheWVyLCAiRm9yY2UgYm9keSB5YXcgdmFsdWUiKSA9PSAwIG9yIHBsaXN0LmdldChwbGF5ZXIsICJGb3JjZSBib2R5IHlhdyIpID09IGZhbHNlIHRoZW4NCiAgICAgICAgaGl0X21lc3NhZ2UgPSBzdHJpbmcuZm9ybWF0KCJ1aXNuZyBkZWZhdWx0IHJpcHRpZGUiKQ0KICAgIGVsc2UNCiAgICAgICAgaGl0X21lc3NhZ2UgPSBzdHJpbmcuZm9ybWF0KCJDbGllbnQgc2hvdCBpbiBlbmVteSA6JXMgfCArLy0gJXMgaml0dGVyIHwgcmlwdGlkZSBmaXg6ICVzIHwgcmVzb2x2ZXIgbWV0aG9kOiAlcyB8IGFpbWVkIGhpdGJveDogJXMgfCBicm9rZW4gbGM6ICVzIHwgYmFja3RyYWNraW5nOiAlcyAoJXMpIHwgZGVzeW5jc2l6ZTogJXMiLCANCiAgICAgICAgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCksIA0KICAgICAgICBsb2cuZGVzeW5jc2l6ZSAqIDAuMywNCiAgICAgICAgc3RvcmVkX3Nob3QuYm9vc3RlZCwgDQogICAgICAgIHJlc29sdmVyX21ldGhvZCwgDQogICAgICAgIGdyb3VwOmxvd2VyKCksIA0KICAgICAgICBpc19kZWZlbnNpdmUsIA0KICAgICAgICBidF9vbiwgDQogICAgICAgIGdsb2JhbHMudGlja2NvdW50KCkgLSBlLnRpY2ssIA0KICAgICAgICBsb2cuZGVzeW5jc2l6ZSkNCiAgICBlbmQNCiAgICBjbGllbnQuY29sb3JfbG9nKDI1NSwgMjU1LCAyNTUsIltqaXR0ZXIgZml4XSAiIC4uIGhpdF9tZXNzYWdlKQ0KZW5kKQ0KDQoNCmxvY2FsIGZ1bmN0aW9uIGRyYXdfY2lyY2xlXzNkKHgsIHksIHosIHJhZGl1cywgciwgZywgYiwgYSwgYWNjdXJhY3ksIHdpZHRoLCBvdXRsaW5lLCBzdGFydF9kZWdyZWVzLCBwZXJjZW50YWdlLCBmaWxsX3IsIGZpbGxfZywgZmlsbF9iLCBmaWxsX2EpDQoJbG9jYWwgYWNjdXJhY3kgPSBhY2N1cmFjeSB+PSBuaWwgYW5kIGFjY3VyYWN5IG9yIDMNCglsb2NhbCB3aWR0aCA9IHdpZHRoIH49IG5pbCBhbmQgd2lkdGggb3IgMQ0KCWxvY2FsIG91dGxpbmUgPSBvdXRsaW5lIH49IG5pbCBhbmQgb3V0bGluZSBvciBmYWxzZQ0KCWxvY2FsIHN0YXJ0X2RlZ3JlZXMgPSBzdGFydF9kZWdyZWVzIH49IG5pbCBhbmQgc3RhcnRfZGVncmVlcyBvciAwDQoJbG9jYWwgcGVyY2VudGFnZSA9IHBlcmNlbnRhZ2Ugfj0gbmlsIGFuZCBwZXJjZW50YWdlIG9yIDENCg0KCWxvY2FsIGNlbnRlcl94LCBjZW50ZXJfeQ0KCWlmIGZpbGxfYSB0aGVuDQoJCWNlbnRlcl94LCBjZW50ZXJfeSA9IHJlbmRlcmVyX3dvcmxkX3RvX3NjcmVlbih4LCB5LCB6KQ0KCWVuZA0KDQoJbG9jYWwgc2NyZWVuX3hfbGluZV9vbGQsIHNjcmVlbl95X2xpbmVfb2xkDQoJZm9yIHJvdD1zdGFydF9kZWdyZWVzLCBwZXJjZW50YWdlKjM2MCwgYWNjdXJhY3kgZG8NCgkJbG9jYWwgcm90X3RlbXAgPSBtYXRoX3JhZChyb3QpDQoJCWxvY2FsIGxpbmVYLCBsaW5lWSwgbGluZVogPSByYWRpdXMgKiBtYXRoX2Nvcyhyb3RfdGVtcCkgKyB4LCByYWRpdXMgKiBtYXRoX3Npbihyb3RfdGVtcCkgKyB5LCB6DQoJCWxvY2FsIHNjcmVlbl94X2xpbmUsIHNjcmVlbl95X2xpbmUgPSByZW5kZXJlcl93b3JsZF90b19zY3JlZW4obGluZVgsIGxpbmVZLCBsaW5lWikNCgkJaWYgc2NyZWVuX3hfbGluZSB+PW5pbCBhbmQgc2NyZWVuX3hfbGluZV9vbGQgfj0gbmlsIHRoZW4NCgkJCWlmIGZpbGxfYSBhbmQgY2VudGVyX3ggfj0gbmlsIHRoZW4NCgkJCQlyZW5kZXJlcl90cmlhbmdsZShzY3JlZW5feF9saW5lLCBzY3JlZW5feV9saW5lLCBzY3JlZW5feF9saW5lX29sZCwgc2NyZWVuX3lfbGluZV9vbGQsIGNlbnRlcl94LCBjZW50ZXJfeSwgZmlsbF9yLCBmaWxsX2csIGZpbGxfYiwgZmlsbF9hKQ0KCQkJZW5kDQoJCQlmb3IgaT0xLCB3aWR0aCBkbw0KCQkJCWxvY2FsIGk9aS0xDQoJCQkJcmVuZGVyZXJfbGluZShzY3JlZW5feF9saW5lLCBzY3JlZW5feV9saW5lLWksIHNjcmVlbl94X2xpbmVfb2xkLCBzY3JlZW5feV9saW5lX29sZC1pLCByLCBnLCBiLCBhKQ0KCQkJCXJlbmRlcmVyX2xpbmUoc2NyZWVuX3hfbGluZS0xLCBzY3JlZW5feV9saW5lLCBzY3JlZW5feF9saW5lX29sZC1pLCBzY3JlZW5feV9saW5lX29sZCwgciwgZywgYiwgYSkNCgkJCWVuZA0KCQkJaWYgb3V0bGluZSB0aGVuDQoJCQkJbG9jYWwgb3V0bGluZV9hID0gYS8yNTUqMTYwDQoJCQkJcmVuZGVyZXJfbGluZShzY3JlZW5feF9saW5lLCBzY3JlZW5feV9saW5lLXdpZHRoLCBzY3JlZW5feF9saW5lX29sZCwgc2NyZWVuX3lfbGluZV9vbGQtd2lkdGgsIDE2LCAxNiwgMTYsIG91dGxpbmVfYSkNCgkJCQlyZW5kZXJlcl9saW5lKHNjcmVlbl94X2xpbmUsIHNjcmVlbl95X2xpbmUrMSwgc2NyZWVuX3hfbGluZV9vbGQsIHNjcmVlbl95X2xpbmVfb2xkKzEsIDE2LCAxNiwgMTYsIG91dGxpbmVfYSkNCgkJCWVuZA0KCQllbmQNCgkJc2NyZWVuX3hfbGluZV9vbGQsIHNjcmVlbl95X2xpbmVfb2xkID0gc2NyZWVuX3hfbGluZSwgc2NyZWVuX3lfbGluZQ0KCWVuZA0KZW5kDQoNCmxvY2FsIGhvdGtleV9wcmV2LCBzaG90cywgcG9zX3gsIHBvc195LCBwb3NfeiA9IGZhbHNlLCAwDQpsb2NhbCBxdWlja3N0b3BfcHJldiwgcXVpY2tzdG9wX2FsbG93ZWQsIHN0YW5kaW5nDQoNCmxvY2FsIGZ1bmN0aW9uIHVwZGF0ZV92aXNpYmxpdHkoKQ0KCWxvY2FsIGVuYWJsZWQgPSB1aV9nZXQoZW5hYmxlZF9yZWZlcmVuY2UpDQoNCglpZiBub3QgZW5hYmxlZCB0aGVuDQoJCWhvdGtleV9wcmV2ID0gZmFsc2UNCgkJcG9zX3ggPSBuaWwNCgllbmQNCmVuZA0KdWlfc2V0X2NhbGxiYWNrKGVuYWJsZWRfcmVmZXJlbmNlLCB1cGRhdGVfdmlzaWJsaXR5KQ0KdXBkYXRlX3Zpc2libGl0eSgpDQoNCmxvY2FsIGZ1bmN0aW9uIG9uX3BhaW50KCkNCglsb2NhbCBwbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpOw0KDQogICAgaWYgKG5vdCBwbGF5ZXIgb3IgZW50aXR5LmdldF9wcm9wKHBsYXllciwgIm1fbGlmZVN0YXRlIikgfj0gMCkgdGhlbg0KICAgICAgICByZXR1cm47DQogICAgZW5kDQoNCiAgICBsb2NhbCBlbnRpdHlfd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKHBsYXllcik7DQoNCiAgICAtLSBJZiBvdXIgd2VhcG9uIGVudGl0eSBkb2Vzbid0IGV4aXN0DQogICAgaWYgKG5vdCBlbnRpdHlfd2VhcG9uKSB0aGVuDQogICAgICAgIHJldHVybjsNCiAgICBlbmQNCg0KICAgIGxvY2FsIHdlYXBvbl9pbmRleCA9IGJpdC5iYW5kKGVudGl0eS5nZXRfcHJvcChlbnRpdHlfd2VhcG9uLCAibV9pSXRlbURlZmluaXRpb25JbmRleCIpLCAweEZGRkYpOw0KCWlmIHdlYXBvbl9pbmRleCA9PSA0MiB0aGVuDQoJCXJldHVybg0KCWVuZA0KCQ0KCWxvY2FsIGlzX2VuYWJsZWQgPSB1aV9nZXQoZW5hYmxlZF9yZWZlcmVuY2UpIGFuZCB1aV9nZXQoaG90a2V5X3JlZmVyZW5jZSkgYW5kIHBvc194IH49IG5pbCBhbmQgZW50aXR5X2lzX2FsaXZlKGVudGl0eV9nZXRfbG9jYWxfcGxheWVyKCkpDQoNCglpZiBub3QgaXNfZW5hYmxlZCBvciBub3QgdWlfZ2V0KGRyYXdfcmVmZXJlbmNlKSB0aGVuDQoJCXJldHVybg0KCWVuZA0KDQoJbG9jYWwgd3gsIHd5ID0gcmVuZGVyZXJfd29ybGRfdG9fc2NyZWVuKHBvc194LCBwb3NfeSwgcG9zX3opDQoNCglpZiB3eCB+PSBuaWwgdGhlbg0KICAgICAgICBsb2NhbCByLCBnLCBiLCBhID0gdWlfZ2V0KGNvbG9yX3JlZmVyZW5jZSkNCiAgICAgICAgDQoJCWRyYXdfY2lyY2xlXzNkKHBvc194LCBwb3NfeSwgcG9zX3osIDE0LCByLCBnLCBiLCBhLCAzLCAyLCBmYWxzZSwgMCwgMSwgciwgZywgYiwgYSowLjYpDQoJZW5kDQplbmQNCmNsaWVudF9zZXRfZXZlbnRfY2FsbGJhY2soInBhaW50Iiwgb25fcGFpbnQpDQoNCg0KbG9jYWwgZnVuY3Rpb24gb25fc2V0dXBfY29tbWFuZChjbWQpDQoJaWYgbm90IHVpX2dldChlbmFibGVkX3JlZmVyZW5jZSkgdGhlbg0KCQlyZXR1cm4NCgllbmQNCg0KCWxvY2FsIGhvdGtleSA9IHVpX2dldChob3RrZXlfcmVmZXJlbmNlKQ0KDQoJbG9jYWwgcGxheWVyID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKTsNCg0KICAgIGlmIChub3QgcGxheWVyIG9yIGVudGl0eS5nZXRfcHJvcChwbGF5ZXIsICJtX2xpZmVTdGF0ZSIpIH49IDApIHRoZW4NCiAgICAgICAgcmV0dXJuOw0KICAgIGVuZA0KDQogICAgbG9jYWwgZW50aXR5X3dlYXBvbiA9IGVudGl0eS5nZXRfcGxheWVyX3dlYXBvbihwbGF5ZXIpOw0KDQogICAgaWYgKG5vdCBlbnRpdHlfd2VhcG9uKSB0aGVuDQogICAgICAgIHJldHVybjsNCiAgICBlbmQNCg0KICAgIGxvY2FsIHdlYXBvbl9pbmRleCA9IGJpdC5iYW5kKGVudGl0eS5nZXRfcHJvcChlbnRpdHlfd2VhcG9uLCAibV9pSXRlbURlZmluaXRpb25JbmRleCIpLCAweEZGRkYpOw0KCWlmIHdlYXBvbl9pbmRleCA9PSA0MiB0aGVuDQoJCXJldHVybg0KCWVuZA0KDQogICAgbG9jYWwgb25fZ3JvdW5kID0gYml0LmJhbmQoZW50aXR5LmdldF9wcm9wKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCksICJtX2ZGbGFncyIpLCAxKQ0KDQoJaWYgaG90a2V5IHRoZW4NCiAgICAgICAgbG9jYWwgbG9jYWxfcGxheWVyID0gZW50aXR5X2dldF9sb2NhbF9wbGF5ZXIoKQ0KDQoJCWlmIG5vdCBob3RrZXlfcHJldiBhbmQgb25fZ3JvdW5kID09IDEgdGhlbg0KCQkJcG9zX3gsIHBvc195LCBwb3NfeiA9IGVudGl0eV9nZXRfcHJvcChsb2NhbF9wbGF5ZXIsICJtX3ZlY0Fic09yaWdpbiIpDQoJCWVuZA0KCWVsc2UNCgkJcG9zX3ggPSBuaWwNCgllbmQNCg0KICAgIGlmIG9uX2dyb3VuZCA9PSAxIHRoZW4NCg0KICAgIGhvdGtleV9wcmV2ID0gaG90a2V5DQogICAgZW5kDQplbmQNCg0KY2xpZW50X3NldF9ldmVudF9jYWxsYmFjaygic2V0dXBfY29tbWFuZCIsIG9uX3NldHVwX2NvbW1hbmQp"}
